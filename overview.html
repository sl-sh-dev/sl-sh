<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Overview - Slosh Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Slosh Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-readme"><a class="header" href="#the-readme">The Readme</a></h1>
<img src="https://raw.githubusercontent.com/sl-sh-dev/sl-sh/gh-pages-legacy/images/sl-sh-ascii-logo.png" alt="sl-sh logo" style="max-width:100%;">
<h1 id="simple-lisp-shell-pronounced-slosh"><a class="header" href="#simple-lisp-shell-pronounced-slosh">Simple Lisp Shell (pronounced slosh)</a></h1>
<p><a href="https://github.com/sl-sh-dev/sl-sh/actions/workflows/rust.yml"><img src="https://github.com/sl-sh-dev/sl-sh/actions/workflows/rust.yml/badge.svg" alt="Rust" /></a></p>
<h2 id="note-this-is-a-new-experimental-version-see-legacy-for-the-original-version-slush"><a class="header" href="#note-this-is-a-new-experimental-version-see-legacy-for-the-original-version-slush">Note this is a new experimental version, see ./legacy/ for the original version (slush).</a></h2>
<p>Simple Lisp SHell (slosh) is a lisp based shell written in Rust. It is not POSIX
compliant and makes no effort to be. Sl-sh should run on any *nix platform as
well as macOS (CI currently only tests against ubuntu and macOS).It is a Lisp-1
that is heavily inspired by Clojure and Common Lisp. It is a shell, it is a
scripting language, and it is a REPL.</p>
<p>Some of the more prominent features:</p>
<ul>
<li>
<p>The terminal contains both a shell and a lisp reader so familiar bash-isms like</p>
<pre><code>cat file | tr -s " " | cut -d " " -f 2,4
</code></pre>
<p>"just work", but starting a command with a lisp form (an s-expression) allows:</p>
<pre><code>(dotimes 10 (prn "hello world"))
</code></pre>
<p>and the "boundary" can be easily crossed, the <code>$()</code> syntax calls out to the shell from within slosh code.</p>
<pre><code>(let ([pid, out] $(ls :&gt;)) (iter::for l in (iter::iter out) (pr l)))
</code></pre>
</li>
<li>
<p>Support for an rc/init file, <code>~/.config/slosh/init.slosh</code>, to set up environment and fully customize your prompt.</p>
</li>
<li>
<p>Common Lisp style macro system with support for quote and backquote (with clojure style ~ and ~@ expansion).</p>
</li>
<li>
<p>Dynamically Typed</p>
</li>
<li>
<p>Note lacks many features from legacy sl-sh but catching up (std lib is currently tiny).</p>
</li>
</ul>
<p>Contains these crates:</p>
<ul>
<li>slosh: a REPL with debugger and extensions that use compiler, includes shell functionality.</li>
<li>compiler: the core compiler code</li>
<li>compile_state: helper crate with state contained by a VM for use with compiler</li>
<li>vm: this is the bytecode VM that is target of the compiler</li>
<li>builtins: set of some core builtins</li>
<li>shell: contains shell specific code, this includes a shell reader (parser), job control etc</li>
<li>bridge_macros: macros for exported Rust functions as slosh functions</li>
<li>bridge_types: helper types for code using bridge_macros</li>
<li>slosh_test: everything in slosh plus some additional functionality and dependencies related to debugging.</li>
<li>legacy (excluded): original sl-sh version, more complete but slower and worse core shell support</li>
</ul>
<h2 id="running"><a class="header" href="#running">Running</a></h2>
<p>cargo run -p slosh</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<h3 id="1-get-sl-sh"><a class="header" href="#1-get-sl-sh">1. Get sl-sh</a></h3>
<ul>
<li><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">Install git</a>
<pre><code>git clone https://github.com/sl-sh-dev/sl-sh
cd slsh
</code></pre>
</li>
</ul>
<h3 id="2-build-sl-sh"><a class="header" href="#2-build-sl-sh">2. Build sl-sh</a></h3>
<ul>
<li><a href="https://www.rust-lang.org/tools/install">Install Rust</a> and build from source:
<pre><code>
cargo build -p slosh --release
./target/release/slosh
</code></pre>
</li>
</ul>
<h3 id="3-use-sl-sh-as-primary-shell"><a class="header" href="#3-use-sl-sh-as-primary-shell">3. Use sl-sh as primary shell</a></h3>
<ul>
<li>install binary</li>
</ul>
<pre><code>mkdir -p /usr/local/bin
sudo install -m 755 target/release/slosh /usr/local/bin/
</code></pre>
<ul>
<li>add slosh to /etc/shells and change login shell to slosh</li>
</ul>
<pre><code>echo /usr/local/bin/slosh | sudo tee -a /etc/shells
chsh -s /usr/local/bin/slosh
</code></pre>
<h3 id="4-optional-configure-slosh"><a class="header" href="#4-optional-configure-slosh">4. (Optional) Configure slosh</a></h3>
<p>The slosh configuration file lives at ~/.config/slosh/init.slosh. <br>
If you run slosh and the file does not exist, a default one will be created for you. <br>
Review your existing shell configuration files like ~/.bashrc and ~/.bash_profile and manually translate them to slosh syntax and add to your init.slosh file <br>
For example, <code>export JAVA_HOME="/usr/local/opt/openjdk@11/bin/java"</code> becomes <code>(sh "export JAVA_HOME='/usr/local/opt/openjdk@11/bin/java'")</code></p>
<h2 id="compiler"><a class="header" href="#compiler">Compiler</a></h2>
<p>These are a subset of sl-sh forms and most work exactly the same. See the
sl-sh docs at:
https://sl-sh-dev.github.io/sl-sh/</p>
<h3 id="primitive-types"><a class="header" href="#primitive-types">Primitive types</a></h3>
<ul>
<li>True</li>
<li>False</li>
<li>Nil</li>
<li>String Constant</li>
<li>Symbol</li>
<li>Keyword</li>
<li>Character (chars are grapheme clusters)</li>
<li>Float (56 bit float)</li>
<li>Integer (56 bit signed integer)</li>
<li>Byte</li>
</ul>
<h3 id="heap-allocated-objects-complex-types"><a class="header" href="#heap-allocated-objects-complex-types">Heap allocated objects (complex types)</a></h3>
<ul>
<li>Pair/ConsCell</li>
<li>Vector</li>
<li>HashMap</li>
<li>String</li>
</ul>
<h3 id="special-forms"><a class="header" href="#special-forms">Special Forms</a></h3>
<p>The following special forms are currently in the compiler:</p>
<ul>
<li>def</li>
<li>set!</li>
<li>do</li>
<li>fn</li>
<li>macro</li>
<li>if</li>
<li>quote (')</li>
<li>back-quote (` supports ~ ~@)</li>
<li>and</li>
<li>or</li>
<li>err</li>
<li>let</li>
<li>call/cc</li>
<li>defer</li>
<li>on-error</li>
<li>while</li>
</ul>
<h3 id="compiled-forms"><a class="header" href="#compiled-forms">Compiled Forms</a></h3>
<p>Normal forms follow normal calling evaluation.
Note: These are all compiled to bytecode and once compiled are not dynamic anymore.</p>
<ul>
<li>not</li>
<li>recur</li>
<li>this-fn</li>
<li>type</li>
<li>
<ul>
<li></li>
</ul>
</li>
<li>
<ul>
<li></li>
</ul>
</li>
<li>*</li>
<li>/</li>
<li>inc!</li>
<li>dec!</li>
<li>list</li>
<li>list-append</li>
<li>cons</li>
<li>car</li>
<li>cdr</li>
<li>xar!</li>
<li>xdr!</li>
<li>vec</li>
<li>make-vec</li>
<li>vec-push!</li>
<li>vec-pop!</li>
<li>str</li>
<li>=</li>
<li>/=</li>
<li>&lt;</li>
<li>&lt;=</li>
<li>&gt;</li>
<li>&gt;=</li>
<li>eq?</li>
<li>equal?</li>
</ul>
<h3 id="features"><a class="header" href="#features">Features</a></h3>
<ul>
<li>Lisp reader (no reader macros yet)</li>
<li>Lisp lists (pair/conscell based)</li>
<li>Vectors</li>
<li>Tail call optimization</li>
<li>Continuations (call/cc)</li>
<li>Lambda/Closures (supports optional and variadic arguments)</li>
<li>Garbage collection (basic but should function)</li>
<li>Lisp back quotes (including nested back quotes)</li>
<li>Macros</li>
</ul>
<h2 id="slosh"><a class="header" href="#slosh">slosh</a></h2>
<p>Slosh is the shell and scripting language REPL using the compiler, vm and shell crates.</p>
<h3 id="built-in-forms"><a class="header" href="#built-in-forms">Built-in Forms</a></h3>
<p>These forms (written in Rust but callable from Lisp) are supported.</p>
<ul>
<li>pr (print)</li>
<li>prn (println)</li>
<li>dasm (disassemble a lambda or closure)</li>
<li>load (load a lisp file and execute it)</li>
<li>vec-slice (new vec that is a slice of old vec)</li>
<li>vec-&gt;list (turn a vec to a list)</li>
<li>get-prop (get a property from an object- either a global variable or a heap object)</li>
<li>set-prop (set a property on an object- either a global variable or a heap object)</li>
<li>eval (eval an expression)</li>
</ul>
<h3 id="features-1"><a class="header" href="#features-1">Features</a></h3>
<ul>
<li>Line editor with history</li>
<li>Debug on error, currently useful for probing VM state only</li>
</ul>
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<ul>
<li>sl-sh legacy shell: https://github.com/sl-sh-dev/sl-sh/legacy</li>
</ul>
<h3 id="benchmarking"><a class="header" href="#benchmarking">Benchmarking</a></h3>
<ul>
<li>Install <a href="https://bencher.dev/docs/tutorial/quick-start/">bencher</a></li>
<li>To run benchmarks locally: <code>cargo bench</code></li>
<li>To upload benchmarks to bencher.dev: <code>bencher run "cargo bench"</code></li>
<li>Consider using iai in cloud: https://bencher.dev/learn/benchmarking/rust/iai/</li>
</ul>
<h3 id="generated-documentation"><a class="header" href="#generated-documentation">Generated documentation</a></h3>
<p>The <a href="https://sl-sh-dev.github.io/sl-sh/">documentation site</a> is served from the <code>doc</code> directory
based on the <code>doc/mk-site.sh</code> script referenced in the github action <code>.github/workflows/gh_pages.yml</code>.</p>
<p>Documentation can be built and viewed locally as the documentation site is a static set of html files
generated from the source code.</p>
<p>All of this is covered in <code>doc/README.md</code></p>
<p>Must be compiled in lisp-test mode for appropriate documentation functions to be present (<code>cargo build --features lisp-test</code>).</p>
<h1 id="dev-notes"><a class="header" href="#dev-notes">Dev Notes</a></h1>
<h2 id="development-tools"><a class="header" href="#development-tools">Development Tools</a></h2>
<h3 id="just-and-the-justfile"><a class="header" href="#just-and-the-justfile">Just and the Justfile</a></h3>
<p><a href="https://github.com/casey/just">Just</a> is a command runner much like make, but with a simpler syntax.</p>
<p>Optionally, you can <a href="https://github.com/casey/just?tab=readme-ov-file#packages">install Just</a> and use it to help easily test or build slosh.</p>
<p>You can also read the Justfile in the root directory to see the common commands that we use to test and build the project.</p>
<br>
<p>To verify you've installed Just, run <code>just</code> in the project root which should list all available commands.</p>
<p>Now you can run <code>just test</code> instead of the verbose <code>sh scripts/check-clippy-version.sh &amp;&amp; cargo fmt &amp;&amp; cargo clippy &amp;&amp; cargo test --workspace</code>.</p>
<p>It's also possible to <a href="https://github.com/casey/just?tab=readme-ov-file#shell-completion-scripts">set up shell completion scripts</a> which makes it quite quick to find the right command.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="welcome.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="shell-vs-lisp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="welcome.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="shell-vs-lisp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
